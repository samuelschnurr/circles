@using System.Net.Http.Json
@using Io.Schnurr.Circles.App.Store.App;
@using Io.Schnurr.Circles.Shared.Models;

@{
    if (IsLoading)
    {
        <ProgressBar IsDrawerOpen="AppState.Value.IsDrawerOpen" />
        return;
    }

    if (!ShowTileView)
    {
        <span id="advertisementTable">
            <MudTable Items="Data" Hover="true" Striped="true" OnRowClick="@((TableRowClickEventArgs<Advertisement> r) => Console.WriteLine(r.Item.Id))">
                <HeaderContent>
                    <MudTh>Id</MudTh>
                    <MudTh>Title</MudTh>
                    <MudTh>Description</MudTh>
                    <MudTh>Price</MudTh>
                    <MudTh>Created</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Id">@context.Id</MudTd>
                    <MudTd DataLabel="Title">@context.Title</MudTd>
                    <MudTd DataLabel="Description">@context.Description</MudTd>
                    <MudTd DataLabel="Price">@context.Price.ToCurrency()</MudTd>
                    <MudTd DataLabel="CreatedAt">@context.CreatedAt.ToShortDateString()</MudTd>
                </RowTemplate>
                <NoRecordsContent>
                    <MudText>No matching records found</MudText>
                </NoRecordsContent>
                <LoadingContent>
                    <MudText>Loading...</MudText>
                </LoadingContent>
                <PagerContent>
                    <MudTablePager />
                </PagerContent>
            </MudTable>
        </span>
        return;
    }

    if (!Data.Any())
    {
        <MudText Class="d-flex justify-center mt-16" Typo="Typo.body1">No matching records found</MudText>
        return;
    }

    <MudGrid Spacing="6">
        @{
            foreach (var d in Data)
            {
                <Tile Title="@d.Title"
                      Description="@d.Description"
                      SubTitleLeft="@d.CreatedAt.ToShortDateString()"
                      SubTitleRight="@d.Price.ToCurrency()"
                      HandleClick="@(() => Console.WriteLine(d.Id))"
                      Image="https://cache.pressmailing.net/thumbnail/story_hires/64940fdd-8ec9-4854-98f9-e7f7467414b7/image.jpg" />
            }
        }
    </MudGrid>
}
